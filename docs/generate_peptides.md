# Instructions to Generate Theoretical Peptides from Sequences Fasta File

This guide gives instructions on generating the theoretical peptides and their m/z values from COL⍺1 and COl1⍺2 fasta sequences.

## Step 1 - Checks Before Starting

Before running the script, please ensure the package 'casi' is correctly installed in your environment. 
This can be checked in the command line with:
```
pip show casi
```
Alternatively use 'pip list' and see if 'casi' is one of the packages listed.

To check with conda:
```
conda list casi
```
Alternatively use 'conda list' and see if 'casi' is one of the packages listed.


### Input - COL1 fasta files

In the study, the COL1⍺1 and COl1⍺2 fasta sequences were downloaded seperately from NCBI protein(https://www.ncbi.nlm.nih.gov/protein/) by searching 'COL1A1' and 'COl1A2' and filtering for 'mammals'. Therefore, there are two fasta input files: a COL1⍺1 input and a COl1⍺2 input. Examples of the input file are in the examples folder here (data/inputs). The fasta input should look like this:
```
>OWK06316.1 COL1A2 [Cervus elaphus hippelaphus]
MVMTASQALLVPLALPAPLVLAGTLLLSLMEKEVALDQWALKVSRDLLVSLVNLVRLVLLVLVAHLVLLA
RLVRMVTLENLDDLVREELLDHRVNLVPLVKMELQVKREPVVSLVREDVLVPLAPLVPVEVMEAWVLWAL
LVPLGLLALQASQVLLAPRVNLDLLVTLALLVPRVPVVKWVFQAFLALLDLLATPEPTGFLVRRVLLACP
```
If the fasta protein sequences are from a different source, the most important thing is that the species name is in brackets at the end of the header line (the line that starts with '>'). If the species information being in a different position in the header is causing a problem please raise an issue or email us.

### Input - LC-MS/MS Data

As mentioned in the paper, the key behind this method is that the theoretical peptide m/z values are filtered using LC-MS/MS data to predict the most likely post-translational modifications. This requires LC-MS/MS data from the species in the class (e.g., mammals) to be available. As default, there are 7 LC-MS/MS files for mammals here: https://github.com/TobyL98/RP1_m-z_speciesidentify/tree/main/src/casi/theoretical_peptides/input_data. If you are identifying a different class, please use different LC-MS/MS file inputs (at least 5 csv files for different species is recommended). The input is a csv file generated by mascot and the columns that are required are: "pep_seq", "pep_score", "pep_start", "pep_end", "pep_exp_mr" ,"pep_miss", "pep_var_mod", "prot_acc". If your LC-MS/MS files are structured differently from the examples above, please raise an issue or email us.

## Step 2 - Generating the Peptides

The script 'theoretical_peps.py' generates the theoretical peptides. To run the script you will require four inputs. The input COL1⍺1 peptide sequence fasta, the input COL1⍺2 peptide sequence fasta, the folder that contains the LC-MS/MS csv files and the folder where the outputs will go. An example command line input is:
```
theoretical_peps -ia1 theoretical_peptides_inputs/COL1A1_seqs_NCBI.fasta -ia2 theoretical_peptides_inputs/COL1A2_seqs_NCBI.fasta -lc theoretical_peptides_inputs/lcmsms_inputs -o theoretical_peptides_outputs
```
Or, if you are using the input **default** LC-MS/MS csv files for mammals:
```
theoretical_peps -ia1 theoretical_peptides_inputs/COL1A1_seqs_NCBI.fasta -ia2 theoretical_peptides_inputs/COL1A2_seqs_NCBI.fasta -o theoretical_peptides_outputs
```
Any further instructions or detail required please look at:
```
theoretical_peps --help
```

## What are the outputs?

The outputs will be within the specified output folder. The output theoretical peptides m/z values for each species will be in csv files within the folder 'filtered_peptides'. The other output folder and files are from other steps within the process and can be scrutinised if there are errors.

## Next Step

The next step is to use these theoretical peptide csv files to predict the species of an unknown ZooMS peptide mass fingerprint. To understand how to do this please look at: docs/predict_species.md